# GLOBAL variables
ubuntu_baseurl: &ubuntu_baseurl http://archive.ubuntu.com/ubuntu
mos_baseurl: &mos_baseurl http://mirror.fuel-infra.org/mos-repos/ubuntu/$mos_version

fuel_release_match:
   version: $openstack_version
   operating_system: Ubuntu

# Main is a required parameter which defines what repository will be used
# for images creation and that mirror should contain all packages for minimal
# system creation.
repos:
    -   &ubuntu
        main: true
        name: "ubuntu"
        uri: *ubuntu_baseurl
        suite: "xenial"
        section: [main, multiverse, restricted, universe]
        type: "deb"
        priority: null

    -   &ubuntu_updates
        name: "ubuntu-updates"
        uri: *ubuntu_baseurl
        suite: "xenial-updates"
        section: [main, multiverse, restricted, universe]
        type: "deb"
        priority: null

    -   &ubuntu_security
        name: "ubuntu-security"
        uri: *ubuntu_baseurl
        suite: "xenial-security"
        section: [main, multiverse, restricted, universe]
        type: "deb"
        priority: null

    -   &mos
        name: "mos"
        uri: "http://2.6.1.2:8080/ubuntu/x86_64"
        suite: "mos$mos_version"
        section: [main, restricted]
        type: "deb"
        priority: 1050

    -   &mos_updates
        name: "mos-updates"
        uri: *mos_baseurl
        suite: "mos$mos_version-updates"
        section: [main, restricted]
        type: "deb"
        priority: 1050

    -   &mos_security
        name: "mos-security"
        uri: *mos_baseurl
        suite: "mos$mos_version-security"
        section: [main, restricted]
        type: "deb"
        priority: 1050

    -   &mos_holdback
        name: "mos-holdback"
        uri: *mos_baseurl
        suite: "mos$mos_version-holdback"
        section: [main, restricted]
        type: "deb"
        priority: 1100

    -   &docker
        name: "docker"
        uri: "https://download.docker.com/linux/ubuntu"
        suite: "xenial"
        section: [stable]
        type: "deb"
        priority: 1100

# Packages are required to build bootstrap images for a system.
# The mirror should contiain such packages in addition to local mirror.
packages: &packages
  - name: "daemonize"
  - name: "fuel-agent"
  - name: "hwloc"
  - name: "i40e-dkms"
  - name: "linux-firmware"
  - name: "linux-headers-generic"
  - name: "live-boot"
  - name: "live-boot-initramfs-tools"
  - name: "mc"
  - name: "mcollective"
  - name: "msmtp-mta"
  - name: "multipath-tools"
  - name: "multipath-tools-boot"
  - name: "nailgun-agent"
  - name: "nailgun-mcagents"
  - name: "network-checker"
  - name: "ntp"
  - name: "ntpdate"
  - name: "openssh-client"
  - name: "openssh-server"
  - name: "puppet"
  - name: "squashfs-tools"
  - name: "ubuntu-minimal"
  - name: "vim"
  - name: "wget"
  - name: "xz-utils"
  - name: "sysfsutils"
  - name: "bridge-utils"
  - name: "ifenslave"
  - name: "irqbalance"
  - name: "iputils-arping"
  - name: "apt-transport-https"
  - name: "linux-image-generic-lts-xenial"
  - name: "cloud-init"
  - name: "linux-headers-generic-lts-xenial"
  - name: "telnet"
  - name: "ubuntu-standard"
  - name: "anacron"
  - name: "rsyslog-gnutls"

docker_packages: &docker_packages:
  - name: docker-ce


groups:
    mos:
        - *mos
        - *mos_updates
        - *mos_security
        - *mos_holdback

    ubuntu:
        - *ubuntu
        - *ubuntu_updates
        - *ubuntu_security

    docker:
        - *docker


#inheritance:
#    ubuntu: mos

osnames:
    mos: ubuntu

requirements:
    ubuntu: 
      packages: *packages
    docker:
      packages: *docker_packages
